# RNA‑seq Processing Pipeline (Internship Project)
This repository contains the shell, R, and Jupyter scripts developed during my internship to process RNA‑seq data on a high‑performance computing cluster and perform downstream statistical and functional analyses in R and Python. Raw sequencing reads are not included due to confidentiality and storage constraints; instead, the repository focuses on a reproducible pipeline, including differential expression (DESeq2), visualization, GO enrichment, GSEA, and selected non‑sensitive figures, together with instructions to generate intermediate files and summary results from accessible input tables.

## Objectives
The goal of this pipeline is to:
- Perform quality control and trimming of RNA-seq data.
- Align reads to a reference genome and generate count tables.
- Run differential expression and basic exploratory analyses.
- Run functional analyses.

## Project Structure
```
.
├── data/                         # Input and derived data
│   ├── 04_htseq/                 # HTSeq count tables
│   ├── 05_deseq/                 # DESeq2 result tables and normalized counts table
│   ├── genes_of_interest/        # Gene lists used for log2FC.R analyses
│   └── Mouse.MitoCarta3.0_mm10to39.bed  # Mitochondrial gene set from MitoCarta in BED format
├── extra/                        # Helper files not used in main pipeline
├── figuras/                      # Figures generated across the analysis
├── trim.sh                       # Read trimming and basic quality filtering on the cluster
├── Mm_gtf_filt.sh                # Preprocessing/filtering of mouse GTF annotation with MITOCarta 3.0
├── htseq_gtf_filt.sh             # Generation/filtering of HTSeq gene count tables
├── 00_read_distribution.R        # Read distribution and QC plots from aligned data
├── 01_deseq.R                    # Core DESeq2 differential expression analysis
├── 01A_tsv2excel.ipynb           # Export DE/summary tables to Excel format
├── 01B_GO_classification.R       # GO classification/enrichment of significant genes
├── 02_log2FC.R                   # Post‑processing and visualization of log2FC results
└── 03_GSEA.R                     # Main GSEA workflow using predefined gene sets
```

For confidentiality and storage reasons, this repository only includes the custom scripts developed during the internship and example configuration files, but not the original data. Intermediate files can be regenerated by running the scripts in the indicated order and adjusting paths and parameters to your environment.

## Usage
The pipeline is organized as a series of shell and R scripts that should be run in the following order:
**1. Pre‑processing on the cluster (shell scripts)**
```
trim.sh
```
- Runs Trim Galore on raw FASTQ files to remove adapters and low‑quality bases.
- Input: raw *.fastq.gz files.
- Output: trimmed FASTQ files and Trim Galore log files (stored in data/ subfolders).
```
Mm_gtf_filt.sh
```
- Filters the mouse GTF annotation to retain genes present in the MitoCarta 3.0 gene set.
- Input: GRCm39 genomic GTF and Mouse.MitoCarta3.0_mm10to39.bed.
- Output: filtered GTF used for downstream HTSeq counting.
```
htseq_gtf_filt.sh
```
- Runs HTSeq on the aligned BAM files using the filtered GTF.
- Input: coordinate‑sorted BAM files, filtered GTF.
- Output: one raw gene‑level count table (*.tsv) per sample in data/04_htseq/.

**2. Quality control and exploratory analysis**
```
00_read_distribution.R
```
- Summarizes read counts per sample (total, mapped, assigned to genes) and generates QC plots (density plots, boxplots, read‑distribution figures).
- Input: HTSeq count tables.
- Output: summary tables and QC figures saved in figuras/ and data/.

**3. Differential expression analysis**
```
01_deseq.R
```
- Performs DESeq2 analysis based on the experimental design.
- Normalizes raw counts, fits the model, and extracts DEGs using the thresholds padj < 0.05 and |log2FC| > 0.379.
- Input: merged count matrix from data/04_htseq/ and sample metadata table.
- Output: DESeq2 result tables and normalized counts in data/05_deseq/, plus PCA and volcano/MA plots in figuras/.

**4. Differential expression post‑processing results**
```
01A_tsv2excel.ipynb
```
- Converts selected DESeq2 result tables to Excel format for easier inspection.
- Input: DESeq2 result *.tsv files.
- Output: Excel spreadsheets.
```
01B_GO_classification.R
```
- Performs GO classification/enrichment on significant DEGs (e.g. lipid metabolism, mitochondrial processes) and generates barplots/pie charts.
- Input: DEG lists from DESeq2 and GO annotation.
- Output: GO enrichment figures saved in figuras/.
```
02_log2FC.R
```
- Extracts log2 fold changes for predefined gene sets (stored in data/genes_of_interest/), generates log2FC visualizations.
- Input: DESeq2 normalized counts and log2FC tables.
- Output: log2FC figures in figuras/.

**5. Functional analysis**
```
03_GSEA.R
```
- Runs Gene Set Enrichment Analysis (GSEA) on ranked gene lists (Wald statistics from DESeq2) using clusterProfiler.
- Input: DESeq2 result tables and gene‑set definitions (e.g. GO, MitoCarta‑based sets).
- Output: GSEA enrichment tables, dot plots and network plots used in the report figures.

### Reproducibility notes
Because raw sequencing data cannot be shared, reproduction of the full pipeline requires access to:
- CBMSO cluster to perform the preprocessing steps
- Sample metadata describing the 14 experimental groups (Table 1 in the Intership Report).

Given equivalent inputs, running the scripts in the order listed above regenerates the count tables, DESeq2 results, GSEA outputs and all figures included in the report.
